const e={NOT_TOKEN_WEBVIEW:"Not imtoken environment.",USER_CANCEL:"user_canceled"},r=()=>{if("undefined"==typeof window)return!1;const e=window;if(void 0===e.imToken)return!1;const r=e.imToken||{};return!r.isSimulated&&!!r.callAPI},t=()=>{if(!r())throw new Error(e.NOT_TOKEN_WEBVIEW);return window.imToken},n=(...e)=>t().callAPI(...e),i=()=>{if(!r())return"";const e=`${navigator.userAgent}`.match(/imtoken\/(.*)/i);return!e||e.length<1?"":e[1]?`${e[1]}`.trim():""},o=(e="",r="")=>{const t=e.split("."),n=r.split(".");for(let i=0;i<3;i++){const e=Number(t[i]),r=Number(n[i]);if(e>r)return 1;if(r>e)return-1;if(!isNaN(e)&&isNaN(r))return 1;if(isNaN(e)&&!isNaN(r))return-1}return 0},a=e=>`${e}`.replace(/#/g,""),s={background:"hbg",foreground:"hfg",isTitleLeft:"title_left",titleSize:"title_size",isTransparent:"trans",transparentScrollY:"trans_y",loadingBackground:"lbg",loadingForeground:"lfg",bodyBackground:"bbg",bodyForeground:"bfg",statusBarStyle:"sfg"},g=["background","foreground","loadingForeground","loadingBackground","bodyBackground","bodyForeground"],u={ERRORS:e,isTokenEnv:()=>r(),isCancelError:r=>{if("string"==typeof r)return r===e.USER_CANCEL;if(r.message===e.USER_CANCEL)return!0;return(e=>void 0!==e.code)(t=r)?4001===t.code:1001===(null==t?void 0:t.errorCode);var t},compareSemver:o,isGreaterThanOrEqualVersion:e=>{const r=i();if(!r)return!1;const t=o(r,e);return!!(e&&t>=0)},getVersion:i,apis:{navigator:{closeDapp:()=>{n("navigator.setTitle")},goBack:()=>{n("navigator.goBack")},toggleNavbar:()=>{n("navigator.toggleNavbar")},routeTo:({screen:e,props:r})=>{n("navigator.routeTo",{screen:e,passProps:r})},getOrientation:()=>new Promise(((e,r)=>{n("navigator.getOrientation",((t,n)=>{if(t)return r(t);e(n)}))})),setOrientation:e=>{n("navigator.setOrientation",`${e}`.toLowerCase())},setTitle:e=>{n("navigator.setTitle",e)}},native:{alert:e=>{n("native.alert",e)},confirm:e=>new Promise((r=>{n("native.confirm",e,(e=>{if(e)return r(!1);r(!0)}))})),setLoading:e=>{n(`native.${e?"showLoading":"hideLoading"}`)},share:e=>{const r=e.image?{title:e.title,url:e.image,type:"image/png"}:e;return new Promise(((e,t)=>{n("native.share",r,((r,n)=>{if(r)return t(r);e(n)}))}))},scanQRCode:()=>new Promise(((e,r)=>{n("native.scanQRCode",((t,n)=>{if(t)return r(t);e(n)}))})),setClipboard:e=>{n("native.setClipboard",e)}},user:{showAccountSwitch:(e=null)=>new Promise(((r,t)=>{n("user.showAccountSwitch",{chainType:e},((e,n)=>{if(e)return t(e);r(n)}))}))},device:{getCurrentLanguage:()=>new Promise(((e,r)=>{n("device.getCurrentLanguage",((t,n)=>{if(t)return r(t);e(n)}))})),getCurrentCurrency:()=>new Promise(((e,r)=>{n("device.getCurrentCurrency",((t,n)=>{if(t)return r(t);e(n)}))}))},internal:{getHeaders:()=>new Promise(((e,r)=>{n("private.getHeaders",((t,n)=>{if(t)return r(t);e(n)}))})),setLogo:e=>{n("private.setLogo",e)},log:(...e)=>{n("private.logo",e)},emitEvent:(e,r)=>new Promise(((t,i)=>{n("private.emitEvent",{eventName:e,params:r||{}},((e,r)=>{if(e)return i(e);t(r)}))})),dangerouslyAPI:(...e)=>n(...e),dangerouslyPromisifyAPI:(...e)=>((...e)=>t().callPromisifyAPI.bind(window.imToken)(...e))(...e)},layout:{setOptions:e=>{const r=Object.keys(e).reduce(((r,t)=>{const n=s[t],i=e[t],o=(c=t,g.includes(c)?(u=i,Array.isArray(u)?u.map(a):a(u)):i);var u,c;return n?Object.assign(Object.assign({},r),{[n]:o}):r}),{});n("layout.setOptions",r)}}}};export{u as T};
